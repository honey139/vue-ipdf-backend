<?php 
$defaultPassword='123456';
date_default_timezone_set('Asia/Qatar');class ColorTable{public $colors;public $so2;public $no2;public $co;public $o3;public $pm;public function __construct($colors,$so2,$no2,$co,$o3,$pm){$this->colors=$colors;$this->so2=$so2;$this->no2=$no2;$this->co=$co;$this->o3=$o3;$this->pm=$pm;}public function displayInfo(){print_r($this->colors);echo('<br/>');print_r($this->so2);echo('<br/>');print_r($this->no2);echo('<br/>');print_r($this->co);echo('<br/>');print_r($this->o3);echo('<br/>');print_r($this->pm);}}$indiciatorFilePath='./csv/indicator.csv';function saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array){$filePath='./csv/colorTable.csv';$data=array($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$csvData='';foreach($data as $row){$csvData.=implode(',',$row)."\n";file_put_contents($filePath,$csvData);}}function saveIndicator($area1_array,$area2_array,$area3_array,$area4_array,$area5_array,$area6_array,$area7_array,$area8_array){$indiciatorFilePath='./csv/indicator.csv';$data=array($area1_array,$area2_array,$area3_array,$area4_array,$area5_array,$area6_array,$area7_array,$area8_array);
    $csvData='';foreach($data as $row){$csvData.=implode(',',$row)."\n";file_put_contents($indiciatorFilePath,$csvData);}}$color_csv=[];$color_array=[];$so2_array=[];$no2_array=[];$co_array=[];$o3_array=[];$pm_array=[];$filePath='./csv/colorTable.csv';$file=fopen($filePath,'r');if($file!==false){$newData=[];while(($row=fgetcsv($file))!==false){$newData=$row;array_push($color_csv,$newData);}fclose($file);}else{echo "Error opening the file.";}$color_array=$color_csv[0];$so2_array=$color_csv[1];$no2_array=$color_csv[2];$co_array=$color_csv[3];$o3_array=$color_csv[4];$pm_array=$color_csv[5];$colorTable=new ColorTable($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array,);$indicatorArray=[];$file=fopen($indiciatorFilePath,'r');if($file!==false){$newData=[];while(($row=fgetcsv($file))!==false){$newData=$row;array_push($indicatorArray,$newData);}fclose($file);}else{echo "Error opening the file.";}$zoneArray=[];$zoneEnglish=[];$zoneArabic=[];$zoneFilePath='./csv/location.csv';$zoneFile=fopen($zoneFilePath,'r');if($zoneFile!==false){$newData=[];while(($row=fgetcsv($zoneFile))!==false){$newData=$row;array_push($zoneArray,$newData);}fclose($zoneFile);}else{echo "Error opening the file.";}$zoneEnglish=$zoneArray[0];$zoneArabic=$zoneArray[1];function saveZone($area1_array,$arabic_array){$zoneFilePath='./csv/location.csv';$data=array($area1_array,$arabic_array);$csvData='';foreach($data as $row){$csvData.=implode(',',$row)."\n";file_put_contents($zoneFilePath,$csvData);}}$fontSizeArray=[];$fontFilePath='./csv/fontSize.csv';$fontFile=fopen($fontFilePath,'r');if($fontFile!==false){$newData=[];while(($row=fgetcsv($fontFile))!==false){$newData=$row;array_push($fontSizeArray,$newData);}fclose($fontFile);}else{echo "Error opening the file.";}$fontSizeInitEn=$fontSizeArray[0][0];$fontStyleInitEn=$fontSizeArray[0][1];$fontSizeInitAr=$fontSizeArray[0][2];$fontStyleInitAr=$fontSizeArray[0][3];$fontcolorInit=$fontSizeArray[0][4];$backgroundColorInit=$fontSizeArray[0][5];$mapColorInit=$fontSizeArray[0][6];$borderColorInit=$fontSizeArray[0][7];$logoTurn=$fontSizeArray[0][8];function saveFontSize($fontArray){$fontFilePath='./csv/fontSize.csv';$data=array($fontArray);$csvData='';foreach($data as $row){$csvData.=implode(',',$row)."\n";file_put_contents($fontFilePath,$csvData);}}$area1_array=$indicatorArray[0];$area2_array=$indicatorArray[1];$area3_array=$indicatorArray[2];$area4_array=$indicatorArray[3];$area5_array=$indicatorArray[4];$area6_array=$indicatorArray[5];$area7_array=$indicatorArray[6];$area8_array=$indicatorArray[7];$response='';if(isset($_POST['action'])){if($_POST['action']=='edit'&&$_POST['id']){if(isset($_POST['good'])){$good=$_POST['good'];}if(isset($_POST['moderate'])){$moderate=$_POST['moderate'];}if(isset($_POST['sensitive'])){$sensitive=$_POST['sensitive'];}if(isset($_POST['unhealthy'])){$unhealthy=$_POST['unhealthy'];}if(isset($_POST['very_unhealthy'])){$very_unhealthy=$_POST['very_unhealthy'];}if(isset($_POST['hazardous_low'])){$hazardous_low=$_POST['hazardous_low'];}if(isset($_POST['hazardous_high'])){$hazardous_high=$_POST['hazardous_high'];}if(isset($_POST['so2'])){$so2=$_POST['so2'];}if(isset($_POST['no2'])){$no2=$_POST['no2'];}if(isset($_POST['co'])){$co=$_POST['co'];}if(isset($_POST['o3'])){$o3=$_POST['o3'];}if(isset($_POST['pm'])){$pm=$_POST['pm'];}if(isset($_POST['area1'])){$area1=$_POST['area1'];}if(isset($_POST['area1'])){$area1=$_POST['area1'];}if(isset($_POST['area2'])){$area2=$_POST['area2'];}if(isset($_POST['area3'])){$area3=$_POST['area3'];}if(isset($_POST['area4'])){$area4=$_POST['area4'];}if(isset($_POST['area5'])){$area5=$_POST['area5'];}if(isset($_POST['area6'])){$area6=$_POST['area6'];}if(isset($_POST['area7'])){$area7=$_POST['area7'];}if(isset($_POST['area8'])){$area8=$_POST['area8'];}if($_POST['id']=='SO2'){$so2_array=[];array_push($so2_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='NO2'){$no2_array=[];array_push($no2_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='CO'){$co_array=[];array_push($co_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='O3'){$o3_array=[];array_push($o3_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='PM'){$pm_array=[];array_push($pm_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='color'){$color_array=[];array_push($color_array,$good,$moderate,$sensitive,$unhealthy,$very_unhealthy,$hazardous_low,$hazardous_high);saveCSV($color_array,$so2_array,$no2_array,$co_array,$o3_array,$pm_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/colorTable.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area1'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($indicator_array,$area2_array,$area3_array,$area4_array,$area5_array,$area6_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area2'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$indicator_array,$area3_array,$area4_array,$area5_array,$area6_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area3'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$indicator_array,$area4_array,$area5_array,$area6_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area4'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$area3_array,$indicator_array,$area5_array,$area6_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area5'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$area3_array,$area4_array,$indicator_array,$area6_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area6'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$area3_array,$area4_array,$area5_array,$indicator_array,$area7_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area7'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$area3_array,$area4_array,$area5_array,$area6_array,$indicator_array,$area8_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Area8'){$indicator_array=[];array_push($indicator_array,$so2,$no2,$co,$o3,$pm);saveIndicator($area1_array,$area2_array,$area3_array,$area4_array,$area5_array,$area6_array,$area7_array,$indicator_array);$updateTime=date('Y-m-d H:i:s',filemtime($indiciatorFilePath));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='English'){$indicator_array=[];array_push($indicator_array,$area1,$area2,$area3,$area4,$area5,$area6,$area7,$area8);saveZone($indicator_array,$zoneArabic);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/location.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='Arabic'){$indicator_array=[];array_push($indicator_array,$area1,$area2,$area3,$area4,$area5,$area6,$area7,$area8);saveZone($zoneEnglish,$indicator_array);$updateTime=date('Y-m-d H:i:s',filemtime('./csv/location.csv'));$response=$updateTime;echo json_encode($response);}if($_POST['id']=='edit_fontSize'){$fontSizeEn=$_POST['fontSizeEn'];$fontStyleEn=$_POST['fontStyleEn'];$fontSizeAr=$_POST['fontSizeAr'];$fontStyleAr=$_POST['fontStyleAr'];$fontColor=$_POST['fontColor'];$backgroundColor=$_POST['backgroundColor'];$mapColor=$_POST['mapColor'];$borderColor=$_POST['borderColor'];$logo=$_POST['logo'];$indicator_array=[];array_push($indicator_array,$fontSizeEn,$fontStyleEn,$fontSizeAr,$fontStyleAr,$fontColor,$backgroundColor,$mapColor,$borderColor,$logo);saveFontSize($indicator_array);}}}$passwordFilePath='./csv/password.csv';$passwordFile=fopen($passwordFilePath,'r');if($passwordFile!==false){$newData=[];while(($row=fgetcsv($passwordFile))!==false){$newData=$row;}fclose($passwordFile);$defaultPassword=$newData[0];}else{echo "Error opening the file.";} 
    ?>